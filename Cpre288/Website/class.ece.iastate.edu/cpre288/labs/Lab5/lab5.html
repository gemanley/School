<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:st1="urn:schemas:contacts"
xmlns:st2="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40"
xmlns:ns0="http://schemas.microsoft.com/office/2004/12/omml">


<!-- Mirrored from class.ece.iastate.edu/cpre288/labs/Lab5/lab5.htm by HTTrack Website Copier/3.x [XR&CO'2010], Wed, 12 Dec 2012 08:16:46 GMT -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="lab5_files/filelist.html">
<link rel=Edit-Time-Data href="lab5_files/editdata.html">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>CPRE 288 Laboratory 5</title>
<o:SmartTagType namespaceuri="urn:schemas:contacts" name="Sn"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="place"/>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Zhao Zhang</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>KT</o:LastAuthor>
  <o:Revision>45</o:Revision>
  <o:TotalTime>620</o:TotalTime>
  <o:Created>2007-09-11T15:52:00Z</o:Created>
  <o:LastSaved>2012-02-12T00:40:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>1884</o:Words>
  <o:Characters>10741</o:Characters>
  <o:Company> </o:Company>
  <o:Lines>89</o:Lines>
  <o:Paragraphs>25</o:Paragraphs>
  <o:CharactersWithSpaces>12600</o:CharactersWithSpaces>
  <o:Version>11.9999</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:Zoom>BestFit</w:Zoom>
  <w:PunctuationKerning/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:SplitPgBreakAndParaMark/>
   <w:DontVertAlignCellWithSp/>
   <w:DontBreakConstrainedForcedTables/>
   <w:DontVertAlignInTxbx/>
   <w:Word11KerningPairs/>
   <w:CachedColBalance/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
  <w:TrackMoves/>
  <w:TrackFormatting/>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>EN-US</w:LidThemeOther>
  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="--"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }st2\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--p.MSONORMAL
	{mso-style-unhide:no;
	mso-style-qformat:yes;}
li.MSONORMAL
	{mso-style-unhide:no;
	mso-style-qformat:yes;}
div.MSONORMAL
	{mso-style-unhide:no;
	mso-style-qformat:yes;}
h1
	{mso-style-unhide:no;
	mso-style-qformat:yes;}
h2
	{mso-style-unhide:no;
	mso-style-qformat:yes;}
h3
	{mso-style-unhide:no;
	mso-style-qformat:yes;}
a:link
	{mso-style-unhide:no;}
span.MSOHYPERLINK
	{mso-style-unhide:no;}
a:visited
	{mso-style-unhide:no;}
span.MSOHYPERLINKFOLLOWED
	{mso-style-unhide:no;}
p
	{mso-style-unhide:no;}
span.HEADING1CHAR
	{mso-style-unhide:no;
	mso-ascii-theme-font:major-latin;
	mso-fareast-theme-font:major-fareast;
	mso-hansi-theme-font:major-latin;
	mso-bidi-theme-font:major-bidi;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.HEADING2CHAR
	{mso-style-unhide:no;
	mso-ascii-theme-font:major-latin;
	mso-fareast-theme-font:major-fareast;
	mso-hansi-theme-font:major-latin;
	mso-bidi-theme-font:major-bidi;
	mso-themecolor:accent1;}
span.HEADING3CHAR
	{mso-style-unhide:no;
	mso-ascii-theme-font:major-latin;
	mso-fareast-theme-font:major-fareast;
	mso-hansi-theme-font:major-latin;
	mso-bidi-theme-font:major-bidi;
	mso-themecolor:accent1;}
p.STYLE1
	{mso-style-unhide:no;}
li.STYLE1
	{mso-style-unhide:no;}
div.STYLE1
	{mso-style-unhide:no;}
span.STYLE11
	{mso-style-unhide:no;}
.MSOCHPDEFAULT
	{mso-default-props:yes;}
table.MSONORMALTABLE
	{mso-style-priority:99;
	mso-style-qformat:yes;}
table.MSOTABLEGRID
	{mso-style-unhide:no;}

 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:\5B8B\4F53;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
@font-face
	{font-family:"\@SimSun";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-536870145 1073743103 0 0 415 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:SimSun;}
h1
	{mso-style-link:"Heading 1 Char";
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:16.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-font-kerning:16.0pt;
	font-weight:bold;}
h2
	{mso-style-link:"Heading 2 Char";
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:14.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;
	font-style:italic;}
h3
	{mso-style-link:"Heading 3 Char";
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:13.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:SimSun;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-locked:yes;
	mso-style-link:"Heading 1";
	mso-ansi-font-size:14.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:Cambria;
	mso-ascii-font-family:Cambria;
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:Cambria;
	mso-bidi-font-family:"Times New Roman";
	color:#365F91;
	font-weight:bold;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-locked:yes;
	mso-style-link:"Heading 2";
	mso-ansi-font-size:13.0pt;
	mso-bidi-font-size:13.0pt;
	font-family:Cambria;
	mso-ascii-font-family:Cambria;
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:Cambria;
	mso-bidi-font-family:"Times New Roman";
	color:#4F81BD;
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-locked:yes;
	mso-style-link:"Heading 3";
	mso-ansi-font-size:12.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Cambria;
	mso-ascii-font-family:Cambria;
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:Cambria;
	mso-bidi-font-family:"Times New Roman";
	color:#4F81BD;
	font-weight:bold;}
p.style1, li.style1, div.style1
	{mso-style-name:style1;
	mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:SimSun;
	text-decoration:underline;
	text-underline:single;}
span.style11
	{mso-style-name:style11;
	text-decoration:underline;
	text-underline:single;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:149903706;
	mso-list-template-ids:755417860;}
@list l1
	{mso-list-id:691221649;
	mso-list-template-ids:-2074330860;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l2
	{mso-list-id:783235768;
	mso-list-template-ids:-917608330;}
@list l2:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l3
	{mso-list-id:973026438;
	mso-list-template-ids:-2102093824;}
@list l3:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l4
	{mso-list-id:973289809;
	mso-list-template-ids:610718140;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l4:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l5
	{mso-list-id:1730498614;
	mso-list-template-ids:-229069698;}
@list l6
	{mso-list-id:1894077913;
	mso-list-template-ids:1991773916;}
@list l6:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
table.MsoTableGrid
	{mso-style-name:"Table Grid";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	border:solid windowtext 1.0pt;
	mso-border-alt:solid windowtext .5pt;
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-border-insideh:.5pt solid windowtext;
	mso-border-insidev:.5pt solid windowtext;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
<link rel=themeData href="lab5_files/themedata.html">
<link rel=colorSchemeMapping href="lab5_files/colorschememapping.html">
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<h1 align=center style='text-align:center'>CPRE 288 Laboratory</h1>

<h1 align=center style='text-align:center'>Lab 5: Serial Communications Using
USART</h1>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2>Lecture – Lab Connection</h2>

<p>In lecture, you have studied the use of the USART. In this lab, you will use
the USART to perform simple serial communication with your desktop computer.</p>

<h2>Prelab&nbsp; </h2>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l4 level1 lfo3;tab-stops:list .5in'>Read
     the lab description as well as the data sheet for the ATMega 128 User
     Guide related to USART. (Starts of pg 172 of <a
     href="../AtmelMega128UG.html">ATMEL Mega 128 User Guide</a>)</li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo3;tab-stops:list .5in'>Draft the
     code. The code need not be complete, and you don’t have to compile or
     execute it before coming to the lab. Attempt to draft some code to show
     your TA.<b><o:p></o:p></b></li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo3;tab-stops:list .5in'>Print
     the Lab Evaluation Form, so that your TA can check off work performed
     during this lab session.</li>
</ul>

<p>Think of answers to the following questions (<a href="../AtmelMega128UG.html">ATMEL
Mega 128 User Guide</a>): </p>

<ol start=1 type=1>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo4;tab-stops:list .5in'><span style='mso-fareast-font-family:
     "Times New Roman"'>What USART registers are relevant to this lab? [2
     points]<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo4;tab-stops:list .5in'><span style='mso-fareast-font-family:
     "Times New Roman"'>What is the value to be loaded into the UBRR registers
     for a baud of 38400? (hint: see table on pg 196) [2 points]<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo4;tab-stops:list .5in'><span style='mso-fareast-font-family:
     "Times New Roman"'>How many USARTs are there on the ATMega 128? Which one
     will you use? [1 point]<o:p></o:p></span></li>
</ol>

<h2>Reference Files</h2>

<p>Download the following files to a single folder on your U: drive
(right-click and select ‘Save Target As’. Alternatively, download the zipped
folder at the bottom of the page).</p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l6 level1 lfo5;tab-stops:list .5in'><span style='mso-fareast-font-family:
     "Times New Roman"'><a href="programs/util.c">util.c</a>/<a
     href="programs/util.h">util.h</a> : The file that contains the utility
     functions for the VORTEX platform. <o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l6 level1 lfo5;tab-stops:list .5in'><span style='mso-fareast-font-family:
     "Times New Roman"'><a href="programs/lcd.c">lcd.c</a>/<a
     href="programs/lcd.h">lcd.h</a> : The program file with a number of LCD
     functions. <o:p></o:p></span></li>
</ul>

<h3><strong><span style='font-family:Arial'>Serial Communication</span></strong></h3>

<p>The USART is capable of synchronous and asynchronous communication. In this
lab, you should be using the <b>Double Speed Asynchronous</b> mode of
communication. Be sure to read the section of the user guide in reference to
the U2X bit in register UCSR0A.</p>

<p>As the term serial implies, information is sent as a sequence of
signals.&nbsp; Signals are grouped together to form serial frames.&nbsp; Serial
frames can contain 5 - 8 bits of payload and have overhead bits to distinguish
the start and end of a frame.&nbsp; There is also an additional overhead bit
available to provide parity.&nbsp; Parity provides simple error detection over
a communication medium that may be noisy.</p>

<p>The rate at which the sequence of signals is sent is called baud.&nbsp;
The term represents the number of distinct symbols transmitted over a medium
per second.&nbsp; A symbol may actually represent more than one 1 bit of
digital information. The term baud is very closely associated with serial
communication and you will find this term used in the ATMega 128 user guide.</p>

<p>In order to communicate successfully between the VORTEX platform and your
lab PC, a number of standards need to be in place.&nbsp; The cable you will be
attaching to the VORTEX's base board with its male DB-9 connector and the
signaling used over that cable all comply to standards.&nbsp; The signaling
standard is RS-232.&nbsp; There is an integrated circuit on the ISU base board
that provides the RS-232 compliant signaling.&nbsp; In RS-232 parlance your PC
is a DTE (Data Terminal Equipment) and the VORTEX's interface is configured to
be a DCE (Data Circuit terminating Equipment).&nbsp; Another set of standards
and conventions have been developed for bluetooth. All of these standards and
conventions are transparent to your programming effort.</p>

<p>The objective of this lab is for you to become familiar with configuring and
using a USART.&nbsp; This is a common element in microcontrollers.&nbsp; USART1
is dedicated to interfacing with the Create. For those of you familiar with
networking and the ISO OSI reference model, this lab is having you configure
and use a rudimentary data link layer laid over a physical layer provided by
RS-232 and the serial cable.</p>

<p>Communication requires two or more participants. The opposite end of the
VORTEX will be your lab PC, but to be precise you will use Putty to facilitate
communications from the PC end. This program is able to talk directly to the
serial port (i.e. COM1) of your PC. As you type characters, ASCII characters
will be sent over the serial connection.</p>

<p>For all parts of this lab, you are to configure Putty to communicate with
your VORTEX platform with the following parameters:</p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l3 level1 lfo6;tab-stops:list .5in'><span style='mso-fareast-font-family:
     "Times New Roman"'>38400 speed (baud)<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l3 level1 lfo6;tab-stops:list .5in'><span style='mso-fareast-font-family:
     "Times New Roman"'>8 Data bits<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l3 level1 lfo6;tab-stops:list .5in'><span style='mso-fareast-font-family:
     "Times New Roman"'>No Parity<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l3 level1 lfo6;tab-stops:list .5in'><span style='mso-fareast-font-family:
     "Times New Roman"'>2 Stop bits<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l3 level1 lfo6;tab-stops:list .5in'><span style='mso-fareast-font-family:
     "Times New Roman"'>No flow control<o:p></o:p></span></li>
</ul>

<p>Naturally, the USART on the VORTEX will have to be configured to communicate
with these same parameters.</p>

<p>Note #1 - In the Terminal section of Putty you can Force local echo so you
can see what you type.</p>

<p>Note #2 - In the Session section of Putty, you can select &quot;Default
Settings&quot; and click Save so you do not have to reconfigure each time you
open the program.</p>

<p><st2:place w:st="on"><st1:Sn w:st="on"><b><i><span style='font-size:14.0pt;
  font-family:Arial'>Part</span></i></b></st1:Sn><b><i><span style='font-size:
 14.0pt;font-family:Arial'> <st1:Sn w:st="on">I.</st1:Sn></span></i></b></st2:place><b><i><span
style='font-size:14.0pt;font-family:Arial'> Receive and Display Text</span></i></b></p>

<p><b>Requirements</b> - Write a program that will receive characters from the
Putty terminal window and displays the entire series of characters when either
Enter has been pressed (the ASCII encoding for &quot;carriage return&quot; is
13 in decimal) or 20 characters have been received. When receiving characters,
a number should appear on the LCD that indicates how many characters are stored
in the buffer, along with displaying the character received.</p>

<p><b>Notes</b> - Putty will transmit a character immediately after you type
it. For debugging purposes, you should display each character on LCD line 1 as
you receive it. You will need to buffer these characters prior to displaying
them all together per the requirements. As each character is placed into a
buffer, display the buffer index value alongside the received character. The
intention of this requirement is to help you with troubleshooting. When Enter
has been received or 20 characters have been received, clear the display prior
to displaying the entire series of characters on LCD line 1.</p>

<p>Putty will not display characters as you type them unless you set up local
echo (Terminal section, Force local echo). You will need to turn off this echo
in the next part of the lab.</p>

<p>Don't worry about editing your series of characters. You don't have to
manage your buffer to accommodate backspace or delete. However, if you are
looking for an additional challenge investigate that feature as well.</p>

<p><b>General Hint</b> - There are C programming examples for initializing,
transmitting, and receiving using the USART on pg 178-182 of the <a
href="../AtmelMega128UG.html">ATMEL Mega 128 User Guide</a>.<br>
<b>Interrupt Hints</b> - Optionally, you could create an interrupt handler for
any of the three interrupts for the USART using the ISR macro:
ISR(USART0_RX_vect), ISR(USART0_UDRE_vect), and ISR(USART0_TX_vect). <br>
These interrupts fire when a receive is complete, the data register is empty,
and a tranmission is complete.<br>
You can look at the chart at the bottom of this <a
href="http://www.nongnu.org/avr-libc/user-manual/group__avr__interrupts.html">page</a>
for more vectors to use in your ISR macro.<br>
Make sure you enable the interrupts by setting the correct pins in the status
and control registers. </p>

<p><b>Demo the program execution on the board to your TA.</b></p>

<p>Note - Make sure the jumper is selecting RS232 for this section. You will
need to switch it to BAM in the last part of the lab.</p>

<p class=MsoNormal><span style='mso-fareast-font-family:"Times New Roman"'><img
border=0 width=478 height=377 id="_x0000_i1026" src=jumper.jpg><o:p></o:p></span></p>

<h2>Part II. Provide Character Echo</h2>

<p>The last part had you focus on receiving characters. Now transmission needs
to be added.&nbsp; Extend your program to transmit each received character back
to Putty. <strong>Turn off local echo</strong> on Putty.</p>

<p>When Enter is pressed only a Carriage Return (‘\r’) is sent by Putty. You
are to send a Line Feed (‘\n’) (ASCII value 10 in decimal) right after you send
the Carriage Return back. This will tell Putty to advance to the next line of
the interface.</p>

<p><b>Demo the program execution on the board to your TA.</b></p>

<h2>Part III. Push Button Response</h2>

<p><b>Requirements</b> - Extend your program from Part I &amp; II to transmit
longer strings to Putty every time a push button is pressed. Your program must
still echo characters that are typed into putty. Make sure that you do not send
repeated messages if the button is held (perhaps have a variable storing the
last state of the push buttons). The required responses are:</p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l2 level1 lfo7;tab-stops:list .5in'><span style='mso-fareast-font-family:
     "Times New Roman"'>SW6 should transmit &quot;Yes&quot;<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l2 level1 lfo7;tab-stops:list .5in'><span style='mso-fareast-font-family:
     "Times New Roman"'>SW5 -&gt; &quot;No&quot;<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l2 level1 lfo7;tab-stops:list .5in'><span style='mso-fareast-font-family:
     "Times New Roman"'>SW4 -&gt; &quot;Blue, no green, Ahhhhh!!!&quot;<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l2 level1 lfo7;tab-stops:list .5in'><span style='mso-fareast-font-family:
     "Times New Roman"'>Be creative with the other three push buttons.<o:p></o:p></span></li>
</ul>

<p><b>Demo the program execution on the board to your TA.</b></p>

<h2>Part IV. Bluetooth (57600 baud)</h2>

<p><b>Requirements</b> - After changing the baud to 57600 and switching
the jumper from RS232 to BAM, run your program from part III over bluetooth. Be
sure you are using Double Speed Asynchronous mode.</p>

<p>First, find out what new value to store in the UBRR0 register to acheive a
57600 baud. If you've only been using the sample code from the manual,
it's important that you make sure you are using double speed asynchronous mode
(search for U2X in the user manual).</p>

<p>On the ISU base board the jumper, JMPR1, needs to be adjusted in order to
switch the receive line from RS-232 to BAM. The jumper cap should be covering
the middle pin and the pin labeled BAM.&nbsp; The ISU base board is designed so
that both interfaces see USART transmissions originating from the ATmega128.</p>

<p><strong>NOTE!</strong> Please keep each BAM associated with its workstation.
COM port assignment is associated with the MAC address of the BAM. Each
distinct BAM connected to a lab PC will be assigned a different COM port.&nbsp;
Although any BAM could be used with a PC, we prefer you use the same BAM with
the same lab PC. We are establishing this convention to minimize the confusion
that will result from inconsistent COM port assignments.&nbsp; The MAC address
of the BAM is provided on the top of the module.&nbsp; You might want to
document the BAM's MAC address and the PC name in the event the BAMs get
switched.</p>

<p>A BAM (the black box) is located next to your PC and will be attached to the
DB25 near the Create's power button. A bluetooth host adapter and supporting
software have been installed on the lab PCs. The bluetooth profile being used
is that of a serial device, so a COM port will be allocated. Putty needs to be
adjusted in order to expect communication on this port. The COM port will be
assigned when you pair the BAM with your PC. On a Windows 7 lab machine, you
can pair your device and computer by:</p>

<ol start=1 type=1>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l5 level1 lfo8;tab-stops:list .5in'><span style='mso-fareast-font-family:
     "Times New Roman"'>In the System Tray, right-click on the Bluetooth logo
     and select <b>Show Bluetooth Devices</b>.<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l5 level1 lfo8;tab-stops:list .5in'><span style='mso-fareast-font-family:
     "Times New Roman"'>If there is already a BAM connected to the PC, you are
     done. Right-click on the device and select <b>Properties</b> to make sure
     its MAC address is correct and to see what COM port it is using (likely
     COM4).<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l5 level1 lfo8;tab-stops:list .5in'><span style='mso-fareast-font-family:
     "Times New Roman"'>If there are no devices connected (or your BAM is not
     connected), select Add a Device. Right-click on properties to inspect the
     MAC address. When you find your device, connect to it using the pairing
     code &quot;0000&quot;.<o:p></o:p></span></li>
</ol>

<p>Now that the environment is setup, test to ensure that Part III still works
using the wireless bluetooth dongle to communicate instead of the serial cable.</p>

<p>Note for the Future: Having the ability to collect data from the VORTEX and
manipulate it on the PC will be very useful in future labs.&nbsp; The BAM
allows data collection to be performed while the VORTEX is away from the bench.</p>

<p><strong>Demonstrate your ability to use bluetooth to your TA.</strong></p>

<h2>Part V. Feedback</h2>

<p>Fill out a lab feedback form: <a
href="https://spreadsheets.google.com/viewform?hl=en&amp;formkey=dDBwV3J1UkxJdnZfTEtZV2NKSzFwU1E6MQ#gid=0">Online
Form</a></p>

<h2>Housekeeping</h2>

<p>Send the VORTEX platform to a home base when your team is through with it.
After each use, please ensure your unit is charging before leaving the lab
room.</p>

<h2>Cautions</h2>
<p>Never leave a powered-down JTAGICE mkII connected to a powered robot - current may leak from
the unit and result in damage to the emulator.  Try to leave the blue JTAGICE mkII box powered on at all times.</p>

<p>Turn the power to the Cerebot board and iRobot off before charging.  The Cerebot board consumes power and the battery will not charge if the robot is in full_mode (which it enters after calling oi_init, turing the power LED yellow).  The robot is charging when the robot's power LED is pulsing red and both green LEDS on the dock are lit.</p>

<p class=MsoNormal><span style='mso-fareast-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></p>

<h2>Reference Files</h2>

<table class=MsoNormalTable border=1 cellpadding=0 width="100%"
 style='width:100.0%;mso-cellspacing:1.5pt;mso-yfti-tbllook:1184;mso-padding-alt:
 0in 5.4pt 0in 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='text-align:center'><b>Files</b></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='text-align:center'><b>Description</b></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><a href="programs/lab5.zip">Lab 5.zip</a></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>&nbsp;Files required for lab 5</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><a href="lab5_eval.doc">Lab Evaluation Form</a></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>&nbsp;Evaluation form for Lab 5</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes'>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><a href="../Lab_Feedback.html">Lab Feedback Form</a> (<a
  href="https://spreadsheets.google.com/viewform?hl=en&amp;formkey=dDBwV3J1UkxJdnZfTEtZV2NKSzFwU1E6MQ#gid=0">Online
  Form</a>)</p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>&nbsp;Tell us what you think of the lab (feedback forms)</p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span style='mso-fareast-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></p>

</div>

</body>


<!-- Mirrored from class.ece.iastate.edu/cpre288/labs/Lab5/lab5.htm by HTTrack Website Copier/3.x [XR&CO'2010], Wed, 12 Dec 2012 08:16:46 GMT -->
</html>
